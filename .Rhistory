# Preparing data
set <- data.frame(2011-diagnozaOsoby2011[,2071],
diagnozaOsoby2011[,51],
diagnozaOsoby2011[,54],
diagnozaOsoby2011[,585], #937
diagnozaOsoby2011[,82],
diagnozaOsoby2011[,1542],
diagnozaOsoby2011[,1530],
diagnozaOsoby2011[,2038],
diagnozaOsoby2011[,1581],
diagnozaOsoby2011[,1582],
diagnozaOsoby2011[,2044])
attr(set,"names") 	<- col.names
levels(set$Sex) 	<- c(NA,"Male","Female")
levels(set$SpeakEng) 	<- c(NA,"Actively","Passively","Not")
levels(set$Education) 	<- c(NA,"AboveDoc","Master","Bachel",
"Vacational","Vacational","Secondary"
,"Vacational","Lower","Lower","Lower","NA")
levels(set$IsDisabled) 	<- c(NA,"High","Medium","Low")
levels(set$IsUnemp) 	<- c(NA,"Yes","No")
rm( diagnozaOsoby2011 )
write.csv2( set , file="./data/data.csv", col.names = TRUE, rown.names = FALSE)
write.csv2( set , file="./data/data.csv", col.names = TRUE, row.names = FALSE)
ls()
plot(set$density(Age,na.rm=TRUE),main="Density plot of Age")
plot(density(set$Age,na.rm=TRUE),main="Density plot of Age")
plot(density(set$Income,na.rm=TRUE),main="Density plot of Income")
set$IsDisabled <- sapply(set$IsDisabled, function(x) { as.factor(if (is.na(x)) "Not" else x) })
set$UnempFreq <- sapply(1:nrow(set),
function(x)
{
if (is.na(set$UnempFreq[x]) && ifelse(is.na(set$WasUnemp[x]),0,set$WasUnemp[x])==2) 0
else set$UnempFreq[x]  })
set$UnempDur <- sapply(1:nrow(set),
function(x) {
if (is.na(set$UnempDur[x]) && ifelse(is.na(set$IsUnemp[x]),"NA",as.character(set$IsUnemp[x]))=="No") 0
else set$UnempDur[x] })
set <- na.omit(set[,c(1,2,3,4,5,6,7,8,9,11)]))
set <- na.omit(set[,c(1,2,3,4,5,6,7,8,9,11)])
head(set)
dim(set)
write.csv2( set , file="./data/data.csv", col.names = TRUE, row.names = FALSE)
set2  <- read.csv2( file="./data/data.csv")
colnames(set2)
set$UenempFreq
set$UnempFreq
attach(set)
summary(UnempDur )
source('~/.active-rstudio-document', echo=TRUE)
hist( UnempDur)
detach(set)
load("./data/diagnozaOsoby2011.RData")
col.names  <- c("Age"
,"Sex"
,"Region"
,"Income"
,"Education"
,"Disabled_Now"
,"Speaks_English"
,"Is_Unemployed"
,"Was_Unemployed"
,"UnempFreq"
,"Unemployment_Spells")
names_of_variables  <-
c(
"Age"
,"Sex"
,"Region"
,"Income"
,"Education"
,"Disabled_Now"
,"Speaks_English"
,"Is_Unemployed"
,"Was_Unemployed"
,"UnempFreq"
,"Unemployment_Spells"
)
set <- data.frame(2011-diagnozaOsoby2011[,2071],
diagnozaOsoby2011[,51],
diagnozaOsoby2011[,54],
diagnozaOsoby2011[,585], #937
diagnozaOsoby2011[,82],
diagnozaOsoby2011[,1542],
diagnozaOsoby2011[,1530],
diagnozaOsoby2011[,2038],
diagnozaOsoby2011[,1581],
diagnozaOsoby2011[,1582],
diagnozaOsoby2011[,2044])
attr(set,"names") 	<- names_of_variables
levels(set$Sex) 	<- c(NA,"Male","Female")
levels(set$SpeakEng) 	<- c(NA,"Actively","Passively","Not")
levels(set$Education) 	<- c(NA,"Above_PHD","Master","Bachelor",
"Vocational","Vocational","Secondary"
,"Vocational","Lower","Lower","Lower","NA")
levels(set$IsDisabled) 	<- c(NA,"High","Medium","Low")
levels(set$IsUnemp) 	<- c(NA,"Yes","No")
names_of_variables  <-
c(
"Age"
,"Sex"
,"Region"
,"Income"
,"Education"
,"Is_Disabled"
,"Speaks_English"
,"Is_Unemployed"
,"Was_Unemployed"
,"UnempFreq"
,"Unemployment_Spells"
)
attr(set,"names") 	<- names_of_variables
levels(set$Sex) 	<- c(NA,"Male","Female")
levels(set$Speaks_English) 	<- c(NA,"Actively","Passively","Not")
levels(set$Education) 	<- c(NA,"Above_PHD","Master","Bachelor",
"Vocational","Vocational","Secondary"
,"Vocational","Lower","Lower","Lower","NA")
levels(set$Is_Disabled) 	<- c(NA,"High","Medium","Low")
levels(set$Is_Unemployed) 	<- c(NA,"Yes","No")
rm( diagnozaOsoby2011 )
set$Is_Disabled <- sapply(set$IsDisabled, function(x) { as.factor(if (is.na(x)) "Not" else x) })
set$Is_Disabled <- sapply(set$Is_Disabled, function(x) { as.factor(if (is.na(x)) "Not" else x) })
names_of_variables  <-
c(
"Age"
,"Sex"
,"Region"
,"Income"
,"Education"
,"Is_Disabled"
,"Speaks_English"
,"Is_Unemployed"
,"Was_Unemployed"
,"Unemployment_Frequency"
,"Unemployment_Spells"
)
attr(set,"names") 	<- names_of_variables
set$Is_Disabled <- sapply(set$Is_Disabled, function(x) { as.factor(if (is.na(x)) "Not" else x) })
set$Unemployment_Frequency <- sapply(1:nrow(set),
function(x)
{
if (is.na(set$UnempFreq[x]) && ifelse(is.na(set$WasUnemp[x]),0,set$WasUnemp[x])==2) 0
else set$UnempFreq[x]  })
set$Unemployment_Frequency <- sapply(1:nrow(set),
function(x)
{
if (is.na(set$Unemployment_Frequency[x]) && ifelse(is.na(set$Was_Unemployed[x]),0,set$Was_Unemployed[x])==2) 0
else set$Unemployment_Frequency[x]  })
set$Unemployment_Spells <- sapply(1:nrow(set),
function(x) {
if (is.na(set$Unemployment_Spells[x]) && ifelse(is.na(set$Is_Unemployed[x]),"NA",as.character(set$Is_Unemployed[x]))=="No") 0
else set$Unemployment_Spells[x] })
set <- na.omit(set[,c(1,2,3,4,5,6,7,8,9,11)])
write.csv2( set , file="./data/data.csv", col.names = TRUE, row.names = FALSE)
set2  <- read.csv2( file="./data/data.csv")
colnames(set2)
rm(c("set","names_of_variables"))
rm("set","names_of_variables")
ls()
rm(colnames)
rm(col.names)
ls()
rm(set2)
rm(data)
ls()
Data  <- read.csv2( file="./data/data.csv")
colnames(Data)
names_of_variables  <-
c(
"Age"
,"Sex"
,"Region"
,"Income"
,"Education"
,"Is_Disabled"
,"Speaks_English"
,"Is_Unemployed"
,"Was_Unemployed"
,"Unemployment_Frequency"
,"Unemployment_Spells"
)
no_of_variables <- length(names_of_variables)
no_of_variables
explanatory_variables <- setdiff( names_of_variables, "Unemployment_Spells")
explanatory_variables
attach(Dane)
attach(Data)
hist(Unemployment_Frequency)
hist(Unemployment_Spells)
hist(Unemployment_Spells)
source('~/.active-rstudio-document', echo=TRUE)
head(Data)
source('~/.active-rstudio-document', echo=TRUE)
Data[Data$Sex == "Female"]
Data$Sex
summary(Data)
load("./data/diagnozaOsoby2011.RData")
names_of_variables  <-
c(
"Age"
,"Sex"
,"Region"
,"Income"
,"Education"
,"Is_Disabled"
,"Speaks_English"
,"Is_Unemployed"
,"Was_Unemployed"
,"Unemployment_Frequency"
,"Unemployment_Spells"
)
# Preparing data
set <- data.frame(2011-diagnozaOsoby2011[,2071],
diagnozaOsoby2011[,51],
diagnozaOsoby2011[,54],
diagnozaOsoby2011[,585], #937
diagnozaOsoby2011[,82],
diagnozaOsoby2011[,1542],
diagnozaOsoby2011[,1530],
diagnozaOsoby2011[,2038],
diagnozaOsoby2011[,1581],
diagnozaOsoby2011[,1582],
diagnozaOsoby2011[,2044])
attr(set,"names") 	<- names_of_variables
levels(set$Sex) 	<- c(NA,"Male","Female")
levels(set$Speaks_English) 	<- c(NA,"Actively","Passively","Not")
levels(set$Education) 	<- c(NA,"Above_PHD","Master","Bachelor",
"Vocational","Vocational","Secondary"
,"Vocational","Lower","Lower","Lower","NA")
levels(set$Is_Disabled) 	<- c(NA,"High","Medium","Low")
levels(set$Is_Unemployed) 	<- c(NA,"Yes","No")
rm( diagnozaOsoby2011 )
summary(set)
set2 <- set
set$Is_Disabled <- sapply(set$Is_Disabled, function(x) { as.factor(if (is.na(x)) "Not" else x) })
set$Unemployment_Frequency <- sapply(1:nrow(set),
function(x)
{
if (is.na(set$Unemployment_Frequency[x]) && ifelse(is.na(set$Was_Unemployed[x]),0,set$Was_Unemployed[x])==2) 0
else set$Unemployment_Frequency[x]  })
set$Unemployment_Spells <- sapply(1:nrow(set),
function(x) {
if (is.na(set$Unemployment_Spells[x]) && ifelse(is.na(set$Is_Unemployed[x]),"NA",as.character(set$Is_Unemployed[x]))=="No") 0
else set$Unemployment_Spells[x] })
set <- na.omit(set[,c(1,2,3,4,5,6,7,8,9,11)])
summary(set)
write.csv2( set , file="./data/data.csv", col.names = TRUE, row.names = TRUE)
rm("set","names_of_variables")
Data  <- read.csv2( file="./data/data.csv")
colnames(Data)
names_of_variables  <-
c(
"Age"
,"Sex"
,"Region"
,"Income"
,"Education"
,"Is_Disabled"
,"Speaks_English"
,"Is_Unemployed"
,"Was_Unemployed"
,"Unemployment_Frequency"
,"Unemployment_Spells"
)
no_of_variables <- length(names_of_variables)
explanatory_variables <- setdiff( names_of_variables, "Unemployment_Spells")
head(Data)
summary(Data)
names_of_explanatory_variables <- setdiff( names_of_variables, "Unemployment_Spells")
colnames(Data)
Data  <- Data[,-1]
colnames(Data)
head(Data)
summary(Data)
ls()
rm(set2)
liczba.braków <- function(x,set){
sum(ifelse(is.na(set[,x]),1,0))
}
NA.NUM <- sapply(col.names,liczba.braków,set=set)
xtable(as.data.frame(NA.NUM),digits=0,caption="Number of NA values in particular variables")
ls()
liczba.braków <- function(x,set){
sum(ifelse(is.na(set[,x]),1,0))
}
NA.NUM <- sapply(names_of_variables ,liczba.braków,set= Data)
xtable(as.data.frame(NA.NUM),digits=0,caption="Number of NA values in particular variables")
ls()
NA.NUM <- sapply(names_of_variables ,liczba.braków,set= Data)
NA.NUM <- sapply(names_of_variables, function(x) liczba.braków(x, Data))
los2 <- sample(1:nrow(set),size=1000,replace=FALSE)
par(mar=c(4,8,4,4),mfrow=c(1,1))
missing.pattern.plot(set[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
title(main = "Missing values pattern")
los2 <- sample(1:nrow(set),size=1000,replace=FALSE)
par(mar=c(4,8,4,4),mfrow=c(1,1))
missing.pattern.plot(set[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
title(main = "Missing values pattern")
library(mlmRev)
los2 <- sample(1:nrow(set),size=1000,replace=FALSE)
los2 <- sample(1:nrow(Data),size=1000,replace=FALSE)
par(mar=c(4,8,4,4),mfrow=c(1,1))
missing.pattern.plot(set[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
library(lattice)
library(mlmRev)
library(mi)
missing.pattern.plot(set[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
missing.pattern.plot(Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
title(main = "Missing values pattern")
par <- oldpar
missing.pattern.plot(Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"),
title(main = "Missing values pattern")
missing.pattern.plot(Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
title(main = "Missing values pattern")
missing.pattern.plot(Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
missing.pattern.plot(Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
title(main = "Missing values pattern")
missing.pattern.plot(Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green", main = "Missing values pattern")
missing.pattern.plot(Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green", title = "Missing values pattern")
load("./data/diagnozaOsoby2011.RData")
names_of_variables  <-
c(
"Age"
,"Sex"
,"Region"
,"Income"
,"Education"
,"Is_Disabled"
,"Speaks_English"
,"Is_Unemployed"
,"Was_Unemployed"
,"Unemployment_Frequency"
,"Unemployment_Spells"
)
set <- data.frame(2011-diagnozaOsoby2011[,2071],
diagnozaOsoby2011[,51],
diagnozaOsoby2011[,54],
diagnozaOsoby2011[,585], #937
diagnozaOsoby2011[,82],
diagnozaOsoby2011[,1542],
diagnozaOsoby2011[,1530],
diagnozaOsoby2011[,2038],
diagnozaOsoby2011[,1581],
diagnozaOsoby2011[,1582],
diagnozaOsoby2011[,2044])
attr(set,"names") 	<- names_of_variables
levels(set$Sex) 	<- c(NA,"Male","Female")
levels(set$Speaks_English) 	<- c(NA,"Actively","Passively","Not")
levels(set$Education) 	<- c(NA,"Above_PHD","Master","Bachelor",
"Vocational","Vocational","Secondary"
,"Vocational","Lower","Lower","Lower","NA")
levels(set$Is_Disabled) 	<- c(NA,"High","Medium","Low")
levels(set$Is_Unemployed) 	<- c(NA,"Yes","No")
write.csv2( set , file="./data/data_censored.csv", col.names = TRUE, row.names = TRUE)
Censored_Data <- read.csv2( file="./data/data_censored.csv")
summary(Censored_Data)
ls()
rm( diagnozaOsoby2011 )
ls()
ls()
rm(set)
missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
print(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
plot(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
plot(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
plot(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
par(mar=c(4,8,4,4),mfrow=c(1,1))
plot(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
par(mar=c(4,8,4,4),mfrow=c(1,1))
plot(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
title(main="")
ls()
oldpar <- par()
par(mar=c(4,8,4,4),mfrow=c(1,1))
plot(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
title(main="")
los2 <- sample(1:nrow(Censored_Data),size=1000,replace=FALSE)
oldpar <- par()
par(mar=c(4,8,4,4),mfrow=c(1,1))
plot(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
los2 <- sample(1:nrow(Censored_Data),size=1000,replace=FALSE)
oldpar <- par()
par(mar=c(4,8,4,4),mfrow=c(1,1))
plot(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
los2 <- sample(1:nrow(Censored_Data),size=1000,replace=FALSE)
oldpar <- par()
par(mar=c(4,8,4,4),mfrow=c(1,1))
plot(missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green"))
los2 <- sample(1:nrow(Censored_Data),size=1000,replace=FALSE)
oldpar <- par()
par(mar=c(4,8,4,4),mfrow=c(1,1))
missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
los2 <- sample(1:nrow(Censored_Data),size=1000,replace=FALSE)
oldpar <- par()
par(mar=c(4,8,4,4),mfrow=c(1,1))
missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
par <- oldpar
los2 <- sample(1:nrow(Censored_Data),size=1000,replace=FALSE)
oldpar <- par()
par(mar=c(4,8,4,4),mfrow=c(1,1))
missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
missing.pattern.plot(Censored_Data[los2,], y.order=T, x.order=T, main="",
obs.col = "orange", mis.col = "green")
los2 <- sample(1:nrow(Censored_Data),size=1000,replace=FALSE)
oldpar <- par()
install.packages("plotrix")
par(mfrow=c(1,2),cex=0.8)
slices_sex <- c(table(Data$Sex))
lbls_sex <- paste(levels(Data$Sex),"\n",slices_sex,sep="")
ls()
ls()
names_of_variables  <-
c(
"Age"
,"Sex"
,"Region"
,"Income"
,"Education"
,"Is_Disabled"
,"Speaks_English"
,"Is_Unemployed"
,"Was_Unemployed"
,"Unemployment_Frequency"
,"Unemployment_Spells"
)
no_of_variables <- length(names_of_variables)
Data  <- read.csv2( file="./data/data.csv")
Data  <- Data[,-1]
names_of_explanatory_variables <- setdiff( names_of_variables, "Unemployment_Spells")
no_of_explanatory_variables <- no_of_variables - 1
ls()
Not_Filled_Histograms <-
lapply(
names_of_variables,
function(x)
{
qplot(
eval(parse(text = x)),
data = Data,
geom="histogram",
ylab="No of people",
xlab=gsub("_", " ", x)
) + coord_flip()
}
)
library(ggplot2)
library(gridExtra)
library(plyr)
library(xtable)
Not_Filled_Histograms <-
lapply(
names_of_variables,
function(x)
{
qplot(
eval(parse(text = x)),
data = Data,
geom="histogram",
ylab="No of people",
xlab=gsub("_", " ", x)
) + coord_flip()
}
)
Not_Filled_Histograms
names_of_explanatory_variables <- setdiff( names_of_variables, c("Unemployment_Spells", "Unemployment_Frequency"))
Not_Filled_Histograms <-
lapply(
names_of_variables,
function(x)
{
qplot(
eval(parse(text = x)),
data = Data,
geom="histogram",
ylab="No of people",
xlab=gsub("_", " ", x)
) + coord_flip()
}
)
Not_Filled_Histograms[[1]]
Not_Filled_Histograms[[2]]
Not_Filled_Histograms[[3]]
Not_Filled_Histograms[[4]]
Not_Filled_Histograms[[5]]
Data
Data$Education
is.factor(Data$Education)
ls()
